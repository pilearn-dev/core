{% extends "layout_new.html" %}
{% block body %}
{% set user_site = "edit" %}
{% set user_edit_site = "login" %}
{% include "user/_header.html" %}
<div class="grid">
  <div class="column2__lg column12 p2">
    {% include "user/edit/_header.html" %}
  </div>
  <div class="column10__lg column12 p2">
    {% if data.id != user.id %}
    <p>Anmeldedaten sind geheim. Zugriff auf diese nur über das &diams;-Tool "Private Daten anzeigen" (mit Protokollierung)</p>
    {% else %}
    <h1>Anmeldedaten für dieses Benutzerkonto</h1>
    <p>Die aktuellen Anmeldedaten für dieses Konto sind:</p>
    <table class="table">
      <tr>
        <th>Anmeldeverfahren</th>
        <td>
          {% set lm = data.getDetail("login_provider") %}
          {% if lm == "local_account" %}
          Lokal (Email+Passwort)
          {% elif lm == "oauth:google" %}
          Anmeldung mit Google
          {% endif %}
        </td>
      </tr>
      <tr>
        <th>E-Mail-Adresse</th>
        <td>{{ data.getDetail("email") }}</td>
      </tr>
    </table>
    <h2>Ändern</h2>
    {% set GRANT_TIME = 10 %}
    {% if session.get("login_time", 0) + GRANT_TIME * 60 > current_time %}
      <div class="_btnlist">
        <a href="?page=login-alter&method=local_account" class="_btn _btn-dark">Lokal (Email+Passwort)</a>
        <a href="?page=login-alter&method=oauth:google" class="_btn _btn-dark">Anmeldung mit Google</a>
      </div>
    {% else %}
    <div class="_alert _alert-danger">
      <p>Aus Sicherheitsgründen erfordern wir eine kürzliche Anmeldung auf diesem Gerät, bevor die Anmeldedaten verändert werden können.</p>
      <p>Bitte bestätige, dass du Zugriff auf dieses Benutzerkonto hast, indem du dich erneut <a href="/auth/login">anmeldest</a>.</p>
    </div>
    {% endif %}
    {% endif %}
  </div>
</div>
{% endblock %}
